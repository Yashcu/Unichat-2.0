import{e as w,r as n,j as e,I as x,B as g,P as _,f,u as C}from"./index-B1mjx8Bh.js";import{D as I,a as D,b as T,c as R,d as U}from"./dialog-B8RRTEFU.js";import{s as k}from"./user-BnCWcz52.js";const A=r=>w.post("/chat/conversations",r),j=({onConversationCreated:r})=>{const[h,o]=n.useState(""),[i,l]=n.useState([]),[a,p]=n.useState([]),[c,t]=n.useState(""),u=async s=>{if(o(s),s.length>2){const d=await k(s);l(d.data)}else l([])},m=s=>{a.find(d=>d._id===s._id)||p([...a,s]),o(""),l([])},N=async()=>{const d={participants:a.map(S=>S._id),name:a.length>1?c:null},y=await A(d);r(y.data)};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(x,{placeholder:"Search for users by name or email...",value:h,onChange:s=>u(s.target.value)}),i.length>0&&e.jsx("div",{className:"border rounded-md mt-2",children:i.map(s=>e.jsxs("div",{onClick:()=>m(s),className:"p-2 hover:bg-gray-100 cursor-pointer",children:[s.name," (",s.email,")"]},s._id))})]}),a.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:"Selected:"}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:a.map(s=>e.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded-full",children:s.name},s._id))})]}),a.length>1&&e.jsx(x,{placeholder:"Group Name (optional)",value:c,onChange:s=>t(s.target.value)}),e.jsx(g,{onClick:N,disabled:a.length===0,children:a.length>1?"Create Group Chat":"Start Chat"})]})};j.propTypes={onConversationCreated:_.func.isRequired};const v=()=>{const{conversations:r,activeConversation:h,setActiveConversation:o}=f(),{user:i}=C(),[l,a]=n.useState(!1),p=t=>{if(t.name)return t.name;const u=t.participants.find(m=>m._id!==i.id);return u?u.name:"Unknown Chat"},c=t=>{o(t._id),a(!1)};return e.jsxs("div",{className:"w-1/4 bg-gray-100 border-r h-full flex flex-col",children:[e.jsxs("div",{className:"p-4 flex justify-between items-center border-b",children:[e.jsx("h2",{className:"font-bold text-lg",children:"Chats"}),e.jsxs(I,{open:l,onOpenChange:a,children:[e.jsx(D,{asChild:!0,children:e.jsx(g,{size:"sm",children:"New Chat"})}),e.jsxs(T,{children:[e.jsx(R,{children:e.jsx(U,{children:"Start a new conversation"})}),e.jsx(j,{onConversationCreated:c})]})]})]}),e.jsx("ul",{className:"flex-1 overflow-y-auto",children:r.map(t=>e.jsx("li",{className:`p-3 hover:bg-gray-200 cursor-pointer ${h===t._id?"bg-blue-100":""}`,onClick:()=>o(t._id),children:p(t)},t._id))})]})};v.propTypes={};const b=()=>{const{messages:r,sendMessage:h,activeConversation:o,loading:i}=f(),{user:l}=C(),[a,p]=n.useState(""),[c,t]=n.useState(!1);return n.useRef(null),e.jsx(e.Fragment,{})};b.propTypes={};const O=()=>e.jsxs("div",{className:"flex h-full border rounded-lg overflow-hidden",children:[e.jsx(v,{}),e.jsx("div",{className:"flex-1 flex flex-col",children:e.jsx(b,{})})]});export{O as default};
